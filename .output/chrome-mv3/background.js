var background=function(){"use strict";var Ke,Ge;function tt(i){return i==null||typeof i=="function"?{main:i}:i}function rt(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var ce={exports:{}},nt=ce.exports,_e;function it(){return _e||(_e=1,function(i,n){(function(o,u){u(i)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:nt,function(o){if(!(globalThis.chrome&&globalThis.chrome.runtime&&globalThis.chrome.runtime.id))throw new Error("This script should only be loaded in a browser extension.");if(globalThis.browser&&globalThis.browser.runtime&&globalThis.browser.runtime.id)o.exports=globalThis.browser;else{const u="The message port closed before a response was received.",y=w=>{const A={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(Object.keys(A).length===0)throw new Error("api-metadata.json has not been included in browser-polyfill");class a extends WeakMap{constructor(I,F=void 0){super(F),this.createItem=I}get(I){return this.has(I)||this.set(I,this.createItem(I)),super.get(I)}}const U=x=>x&&typeof x=="object"&&typeof x.then=="function",M=(x,I)=>(...F)=>{w.runtime.lastError?x.reject(new Error(w.runtime.lastError.message)):I.singleCallbackArg||F.length<=1&&I.singleCallbackArg!==!1?x.resolve(F[0]):x.resolve(F)},h=x=>x==1?"argument":"arguments",C=(x,I)=>function(R,...k){if(k.length<I.minArgs)throw new Error(`Expected at least ${I.minArgs} ${h(I.minArgs)} for ${x}(), got ${k.length}`);if(k.length>I.maxArgs)throw new Error(`Expected at most ${I.maxArgs} ${h(I.maxArgs)} for ${x}(), got ${k.length}`);return new Promise((D,V)=>{if(I.fallbackToNoCallback)try{R[x](...k,M({resolve:D,reject:V},I))}catch(S){console.warn(`${x} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,S),R[x](...k),I.fallbackToNoCallback=!1,I.noCallback=!0,D()}else I.noCallback?(R[x](...k),D()):R[x](...k,M({resolve:D,reject:V},I))})},$=(x,I,F)=>new Proxy(I,{apply(R,k,D){return F.call(k,x,...D)}});let b=Function.call.bind(Object.prototype.hasOwnProperty);const _=(x,I={},F={})=>{let R=Object.create(null),k={has(V,S){return S in x||S in R},get(V,S,G){if(S in R)return R[S];if(!(S in x))return;let P=x[S];if(typeof P=="function")if(typeof I[S]=="function")P=$(x,x[S],I[S]);else if(b(F,S)){let Y=C(S,F[S]);P=$(x,x[S],Y)}else P=P.bind(x);else if(typeof P=="object"&&P!==null&&(b(I,S)||b(F,S)))P=_(P,I[S],F[S]);else if(b(F,"*"))P=_(P,I[S],F["*"]);else return Object.defineProperty(R,S,{configurable:!0,enumerable:!0,get(){return x[S]},set(Y){x[S]=Y}}),P;return R[S]=P,P},set(V,S,G,P){return S in R?R[S]=G:x[S]=G,!0},defineProperty(V,S,G){return Reflect.defineProperty(R,S,G)},deleteProperty(V,S){return Reflect.deleteProperty(R,S)}},D=Object.create(x);return new Proxy(D,k)},p=x=>({addListener(I,F,...R){I.addListener(x.get(F),...R)},hasListener(I,F){return I.hasListener(x.get(F))},removeListener(I,F){I.removeListener(x.get(F))}}),g=new a(x=>typeof x!="function"?x:function(F){const R=_(F,{},{getContent:{minArgs:0,maxArgs:0}});x(R)}),m=new a(x=>typeof x!="function"?x:function(F,R,k){let D=!1,V,S=new Promise(z=>{V=function(J){D=!0,z(J)}}),G;try{G=x(F,R,V)}catch(z){G=Promise.reject(z)}const P=G!==!0&&U(G);if(G!==!0&&!P&&!D)return!1;const Y=z=>{z.then(J=>{k(J)},J=>{let oe;J&&(J instanceof Error||typeof J.message=="string")?oe=J.message:oe="An unexpected error occurred",k({__mozWebExtensionPolyfillReject__:!0,message:oe})}).catch(J=>{console.error("Failed to send onMessage rejected reply",J)})};return Y(P?G:S),!0}),d=({reject:x,resolve:I},F)=>{w.runtime.lastError?w.runtime.lastError.message===u?I():x(new Error(w.runtime.lastError.message)):F&&F.__mozWebExtensionPolyfillReject__?x(new Error(F.message)):I(F)},E=(x,I,F,...R)=>{if(R.length<I.minArgs)throw new Error(`Expected at least ${I.minArgs} ${h(I.minArgs)} for ${x}(), got ${R.length}`);if(R.length>I.maxArgs)throw new Error(`Expected at most ${I.maxArgs} ${h(I.maxArgs)} for ${x}(), got ${R.length}`);return new Promise((k,D)=>{const V=d.bind(null,{resolve:k,reject:D});R.push(V),F.sendMessage(...R)})},B={devtools:{network:{onRequestFinished:p(g)}},runtime:{onMessage:p(m),onMessageExternal:p(m),sendMessage:E.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:E.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},T={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return A.privacy={network:{"*":T},services:{"*":T},websites:{"*":T}},_(w,B,A)};o.exports=y(chrome)}})}(ce)),ce.exports}var st=it();const W=rt(st);var Te=Object.prototype.hasOwnProperty;function ye(i,n){var o,u;if(i===n)return!0;if(i&&n&&(o=i.constructor)===n.constructor){if(o===Date)return i.getTime()===n.getTime();if(o===RegExp)return i.toString()===n.toString();if(o===Array){if((u=i.length)===n.length)for(;u--&&ye(i[u],n[u]););return u===-1}if(!o||typeof i=="object"){u=0;for(o in i)if(Te.call(i,o)&&++u&&!Te.call(n,o)||!(o in n)||!ye(i[o],n[o]))return!1;return Object.keys(n).length===u}}return i!==i&&n!==n}const ot=new Error("request for lock canceled");var at=function(i,n,o,u){function y(w){return w instanceof o?w:new o(function(A){A(w)})}return new(o||(o=Promise))(function(w,A){function a(h){try{M(u.next(h))}catch(C){A(C)}}function U(h){try{M(u.throw(h))}catch(C){A(C)}}function M(h){h.done?w(h.value):y(h.value).then(a,U)}M((u=u.apply(i,n||[])).next())})};class ct{constructor(n,o=ot){this._value=n,this._cancelError=o,this._queue=[],this._weightedWaiters=[]}acquire(n=1,o=0){if(n<=0)throw new Error(`invalid weight ${n}: must be positive`);return new Promise((u,y)=>{const w={resolve:u,reject:y,weight:n,priority:o},A=Re(this._queue,a=>o<=a.priority);A===-1&&n<=this._value?this._dispatchItem(w):this._queue.splice(A+1,0,w)})}runExclusive(n){return at(this,arguments,void 0,function*(o,u=1,y=0){const[w,A]=yield this.acquire(u,y);try{return yield o(w)}finally{A()}})}waitForUnlock(n=1,o=0){if(n<=0)throw new Error(`invalid weight ${n}: must be positive`);return this._couldLockImmediately(n,o)?Promise.resolve():new Promise(u=>{this._weightedWaiters[n-1]||(this._weightedWaiters[n-1]=[]),ut(this._weightedWaiters[n-1],{resolve:u,priority:o})})}isLocked(){return this._value<=0}getValue(){return this._value}setValue(n){this._value=n,this._dispatchQueue()}release(n=1){if(n<=0)throw new Error(`invalid weight ${n}: must be positive`);this._value+=n,this._dispatchQueue()}cancel(){this._queue.forEach(n=>n.reject(this._cancelError)),this._queue=[]}_dispatchQueue(){for(this._drainUnlockWaiters();this._queue.length>0&&this._queue[0].weight<=this._value;)this._dispatchItem(this._queue.shift()),this._drainUnlockWaiters()}_dispatchItem(n){const o=this._value;this._value-=n.weight,n.resolve([o,this._newReleaser(n.weight)])}_newReleaser(n){let o=!1;return()=>{o||(o=!0,this.release(n))}}_drainUnlockWaiters(){if(this._queue.length===0)for(let n=this._value;n>0;n--){const o=this._weightedWaiters[n-1];o&&(o.forEach(u=>u.resolve()),this._weightedWaiters[n-1]=[])}else{const n=this._queue[0].priority;for(let o=this._value;o>0;o--){const u=this._weightedWaiters[o-1];if(!u)continue;const y=u.findIndex(w=>w.priority<=n);(y===-1?u:u.splice(0,y)).forEach(w=>w.resolve())}}}_couldLockImmediately(n,o){return(this._queue.length===0||this._queue[0].priority<o)&&n<=this._value}}function ut(i,n){const o=Re(i,u=>n.priority<=u.priority);i.splice(o+1,0,n)}function Re(i,n){for(let o=i.length-1;o>=0;o--)if(n(i[o]))return o;return-1}var lt=function(i,n,o,u){function y(w){return w instanceof o?w:new o(function(A){A(w)})}return new(o||(o=Promise))(function(w,A){function a(h){try{M(u.next(h))}catch(C){A(C)}}function U(h){try{M(u.throw(h))}catch(C){A(C)}}function M(h){h.done?w(h.value):y(h.value).then(a,U)}M((u=u.apply(i,n||[])).next())})};class ht{constructor(n){this._semaphore=new ct(1,n)}acquire(){return lt(this,arguments,void 0,function*(n=0){const[,o]=yield this._semaphore.acquire(1,n);return o})}runExclusive(n,o=0){return this._semaphore.runExclusive(()=>n(),1,o)}isLocked(){return this._semaphore.isLocked()}waitForUnlock(n=0){return this._semaphore.waitForUnlock(1,n)}release(){this._semaphore.isLocked()&&this._semaphore.release()}cancel(){return this._semaphore.cancel()}}const ue=((Ge=(Ke=globalThis.browser)==null?void 0:Ke.runtime)==null?void 0:Ge.id)==null?globalThis.chrome:globalThis.browser,Ce=ft();function ft(){const i={local:le("local"),session:le("session"),sync:le("sync"),managed:le("managed")},n=p=>{const g=i[p];if(g==null){const m=Object.keys(i).join(", ");throw Error(`Invalid area "${p}". Options: ${m}`)}return g},o=p=>{const g=p.indexOf(":"),m=p.substring(0,g),d=p.substring(g+1);if(d==null)throw Error(`Storage key should be in the form of "area:key", but received "${p}"`);return{driverArea:m,driverKey:d,driver:n(m)}},u=p=>p+"$",y=(p,g)=>{const m={...p};return Object.entries(g).forEach(([d,E])=>{E==null?delete m[d]:m[d]=E}),m},w=(p,g)=>p??g??null,A=p=>typeof p=="object"&&!Array.isArray(p)?p:{},a=async(p,g,m)=>{const d=await p.getItem(g);return w(d,(m==null?void 0:m.fallback)??(m==null?void 0:m.defaultValue))},U=async(p,g)=>{const m=u(g),d=await p.getItem(m);return A(d)},M=async(p,g,m)=>{await p.setItem(g,m??null)},h=async(p,g,m)=>{const d=u(g),E=A(await p.getItem(d));await p.setItem(d,y(E,m))},C=async(p,g,m)=>{if(await p.removeItem(g),m!=null&&m.removeMeta){const d=u(g);await p.removeItem(d)}},$=async(p,g,m)=>{const d=u(g);if(m==null)await p.removeItem(d);else{const E=A(await p.getItem(d));[m].flat().forEach(B=>delete E[B]),await p.setItem(d,E)}},b=(p,g,m)=>p.watch(g,m);return{getItem:async(p,g)=>{const{driver:m,driverKey:d}=o(p);return await a(m,d,g)},getItems:async p=>{const g=new Map,m=new Map,d=[];p.forEach(B=>{let T,x;typeof B=="string"?T=B:"getValue"in B?(T=B.key,x={fallback:B.fallback}):(T=B.key,x=B.options),d.push(T);const{driverArea:I,driverKey:F}=o(T),R=g.get(I)??[];g.set(I,R.concat(F)),m.set(T,x)});const E=new Map;return await Promise.all(Array.from(g.entries()).map(async([B,T])=>{(await i[B].getItems(T)).forEach(I=>{const F=`${B}:${I.key}`,R=m.get(F),k=w(I.value,(R==null?void 0:R.fallback)??(R==null?void 0:R.defaultValue));E.set(F,k)})})),d.map(B=>({key:B,value:E.get(B)}))},getMeta:async p=>{const{driver:g,driverKey:m}=o(p);return await U(g,m)},getMetas:async p=>{const g=p.map(E=>{const B=typeof E=="string"?E:E.key,{driverArea:T,driverKey:x}=o(B);return{key:B,driverArea:T,driverKey:x,driverMetaKey:u(x)}}),m=g.reduce((E,B)=>{var T;return E[T=B.driverArea]??(E[T]=[]),E[B.driverArea].push(B),E},{}),d={};return await Promise.all(Object.entries(m).map(async([E,B])=>{const T=await ue.storage[E].get(B.map(x=>x.driverMetaKey));B.forEach(x=>{d[x.key]=T[x.driverMetaKey]??{}})})),g.map(E=>({key:E.key,meta:d[E.key]}))},setItem:async(p,g)=>{const{driver:m,driverKey:d}=o(p);await M(m,d,g)},setItems:async p=>{const g={};p.forEach(m=>{const{driverArea:d,driverKey:E}=o("key"in m?m.key:m.item.key);g[d]??(g[d]=[]),g[d].push({key:E,value:m.value})}),await Promise.all(Object.entries(g).map(async([m,d])=>{await n(m).setItems(d)}))},setMeta:async(p,g)=>{const{driver:m,driverKey:d}=o(p);await h(m,d,g)},setMetas:async p=>{const g={};p.forEach(m=>{const{driverArea:d,driverKey:E}=o("key"in m?m.key:m.item.key);g[d]??(g[d]=[]),g[d].push({key:E,properties:m.meta})}),await Promise.all(Object.entries(g).map(async([m,d])=>{const E=n(m),B=d.map(({key:F})=>u(F));console.log(m,B);const T=await E.getItems(B),x=Object.fromEntries(T.map(({key:F,value:R})=>[F,A(R)])),I=d.map(({key:F,properties:R})=>{const k=u(F);return{key:k,value:y(x[k]??{},R)}});await E.setItems(I)}))},removeItem:async(p,g)=>{const{driver:m,driverKey:d}=o(p);await C(m,d,g)},removeItems:async p=>{const g={};p.forEach(m=>{let d,E;typeof m=="string"?d=m:"getValue"in m?d=m.key:"item"in m?(d=m.item.key,E=m.options):(d=m.key,E=m.options);const{driverArea:B,driverKey:T}=o(d);g[B]??(g[B]=[]),g[B].push(T),E!=null&&E.removeMeta&&g[B].push(u(T))}),await Promise.all(Object.entries(g).map(async([m,d])=>{await n(m).removeItems(d)}))},clear:async p=>{await n(p).clear()},removeMeta:async(p,g)=>{const{driver:m,driverKey:d}=o(p);await $(m,d,g)},snapshot:async(p,g)=>{var E;const d=await n(p).snapshot();return(E=g==null?void 0:g.excludeKeys)==null||E.forEach(B=>{delete d[B],delete d[u(B)]}),d},restoreSnapshot:async(p,g)=>{await n(p).restoreSnapshot(g)},watch:(p,g)=>{const{driver:m,driverKey:d}=o(p);return b(m,d,g)},unwatch(){Object.values(i).forEach(p=>{p.unwatch()})},defineItem:(p,g)=>{const{driver:m,driverKey:d}=o(p),{version:E=1,migrations:B={}}=g??{};if(E<1)throw Error("Storage item version cannot be less than 1. Initial versions should be set to 1, not 0.");const T=async()=>{var Y;const k=u(d),[{value:D},{value:V}]=await m.getItems([d,k]);if(D==null)return;const S=(V==null?void 0:V.v)??1;if(S>E)throw Error(`Version downgrade detected (v${S} -> v${E}) for "${p}"`);if(S===E)return;console.debug(`[@wxt-dev/storage] Running storage migration for ${p}: v${S} -> v${E}`);const G=Array.from({length:E-S},(z,J)=>S+J+1);let P=D;for(const z of G)try{P=await((Y=B==null?void 0:B[z])==null?void 0:Y.call(B,P))??P}catch(J){throw new gt(p,z,{cause:J})}await m.setItems([{key:d,value:P},{key:k,value:{...V,v:E}}]),console.debug(`[@wxt-dev/storage] Storage migration completed for ${p} v${E}`,{migratedValue:P})},x=(g==null?void 0:g.migrations)==null?Promise.resolve():T().catch(k=>{console.error(`[@wxt-dev/storage] Migration failed for ${p}`,k)}),I=new ht,F=()=>(g==null?void 0:g.fallback)??(g==null?void 0:g.defaultValue)??null,R=()=>I.runExclusive(async()=>{const k=await m.getItem(d);if(k!=null||(g==null?void 0:g.init)==null)return k;const D=await g.init();return await m.setItem(d,D),D});return x.then(R),{key:p,get defaultValue(){return F()},get fallback(){return F()},getValue:async()=>(await x,g!=null&&g.init?await R():await a(m,d,g)),getMeta:async()=>(await x,await U(m,d)),setValue:async k=>(await x,await M(m,d,k)),setMeta:async k=>(await x,await h(m,d,k)),removeValue:async k=>(await x,await C(m,d,k)),removeMeta:async k=>(await x,await $(m,d,k)),watch:k=>b(m,d,(D,V)=>k(D??F(),V??F())),migrate:T}}}}function le(i){const n=()=>{if(ue.runtime==null)throw Error(["'wxt/storage' must be loaded in a web extension environment",`
 - If thrown during a build, see https://github.com/wxt-dev/wxt/issues/371`,` - If thrown during tests, mock 'wxt/browser' correctly. See https://wxt.dev/guide/go-further/testing.html
`].join(`
`));if(ue.storage==null)throw Error("You must add the 'storage' permission to your manifest to use 'wxt/storage'");const u=ue.storage[i];if(u==null)throw Error(`"browser.storage.${i}" is undefined`);return u},o=new Set;return{getItem:async u=>(await n().get(u))[u],getItems:async u=>{const y=await n().get(u);return u.map(w=>({key:w,value:y[w]??null}))},setItem:async(u,y)=>{y==null?await n().remove(u):await n().set({[u]:y})},setItems:async u=>{const y=u.reduce((w,{key:A,value:a})=>(w[A]=a,w),{});await n().set(y)},removeItem:async u=>{await n().remove(u)},removeItems:async u=>{await n().remove(u)},clear:async()=>{await n().clear()},snapshot:async()=>await n().get(),restoreSnapshot:async u=>{await n().set(u)},watch(u,y){const w=A=>{const a=A[u];a!=null&&(ye(a.newValue,a.oldValue)||y(a.newValue??null,a.oldValue??null))};return n().onChanged.addListener(w),o.add(w),()=>{n().onChanged.removeListener(w),o.delete(w)}},unwatch(){o.forEach(u=>{n().onChanged.removeListener(u)}),o.clear()}}}class gt extends Error{constructor(n,o,u){super(`v${o} migration failed for "${n}"`,u),this.key=n,this.version=o}}var we={},ie={},Se;function mt(){if(Se)return ie;Se=1,ie.byteLength=a,ie.toByteArray=M,ie.fromByteArray=$;for(var i=[],n=[],o=typeof Uint8Array<"u"?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",y=0,w=u.length;y<w;++y)i[y]=u[y],n[u.charCodeAt(y)]=y;n[45]=62,n[95]=63;function A(b){var _=b.length;if(_%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var p=b.indexOf("=");p===-1&&(p=_);var g=p===_?0:4-p%4;return[p,g]}function a(b){var _=A(b),p=_[0],g=_[1];return(p+g)*3/4-g}function U(b,_,p){return(_+p)*3/4-p}function M(b){var _,p=A(b),g=p[0],m=p[1],d=new o(U(b,g,m)),E=0,B=m>0?g-4:g,T;for(T=0;T<B;T+=4)_=n[b.charCodeAt(T)]<<18|n[b.charCodeAt(T+1)]<<12|n[b.charCodeAt(T+2)]<<6|n[b.charCodeAt(T+3)],d[E++]=_>>16&255,d[E++]=_>>8&255,d[E++]=_&255;return m===2&&(_=n[b.charCodeAt(T)]<<2|n[b.charCodeAt(T+1)]>>4,d[E++]=_&255),m===1&&(_=n[b.charCodeAt(T)]<<10|n[b.charCodeAt(T+1)]<<4|n[b.charCodeAt(T+2)]>>2,d[E++]=_>>8&255,d[E++]=_&255),d}function h(b){return i[b>>18&63]+i[b>>12&63]+i[b>>6&63]+i[b&63]}function C(b,_,p){for(var g,m=[],d=_;d<p;d+=3)g=(b[d]<<16&16711680)+(b[d+1]<<8&65280)+(b[d+2]&255),m.push(h(g));return m.join("")}function $(b){for(var _,p=b.length,g=p%3,m=[],d=16383,E=0,B=p-g;E<B;E+=d)m.push(C(b,E,E+d>B?B:E+d));return g===1?(_=b[p-1],m.push(i[_>>2]+i[_<<4&63]+"==")):g===2&&(_=(b[p-2]<<8)+b[p-1],m.push(i[_>>10]+i[_>>4&63]+i[_<<2&63]+"=")),m.join("")}return ie}var he={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var ke;function pt(){return ke||(ke=1,he.read=function(i,n,o,u,y){var w,A,a=y*8-u-1,U=(1<<a)-1,M=U>>1,h=-7,C=o?y-1:0,$=o?-1:1,b=i[n+C];for(C+=$,w=b&(1<<-h)-1,b>>=-h,h+=a;h>0;w=w*256+i[n+C],C+=$,h-=8);for(A=w&(1<<-h)-1,w>>=-h,h+=u;h>0;A=A*256+i[n+C],C+=$,h-=8);if(w===0)w=1-M;else{if(w===U)return A?NaN:(b?-1:1)*(1/0);A=A+Math.pow(2,u),w=w-M}return(b?-1:1)*A*Math.pow(2,w-u)},he.write=function(i,n,o,u,y,w){var A,a,U,M=w*8-y-1,h=(1<<M)-1,C=h>>1,$=y===23?Math.pow(2,-24)-Math.pow(2,-77):0,b=u?0:w-1,_=u?1:-1,p=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(a=isNaN(n)?1:0,A=h):(A=Math.floor(Math.log(n)/Math.LN2),n*(U=Math.pow(2,-A))<1&&(A--,U*=2),A+C>=1?n+=$/U:n+=$*Math.pow(2,1-C),n*U>=2&&(A++,U/=2),A+C>=h?(a=0,A=h):A+C>=1?(a=(n*U-1)*Math.pow(2,y),A=A+C):(a=n*Math.pow(2,C-1)*Math.pow(2,y),A=0));y>=8;i[o+b]=a&255,b+=_,a/=256,y-=8);for(A=A<<y|a,M+=y;M>0;i[o+b]=A&255,b+=_,A/=256,M-=8);i[o+b-_]|=p*128}),he}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Ue;function dt(){return Ue||(Ue=1,function(i){const n=mt(),o=pt(),u=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;i.Buffer=a,i.SlowBuffer=d,i.INSPECT_MAX_BYTES=50;const y=2147483647;i.kMaxLength=y,a.TYPED_ARRAY_SUPPORT=w(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function w(){try{const r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function A(r){if(r>y)throw new RangeError('The value "'+r+'" is invalid for option "size"');const e=new Uint8Array(r);return Object.setPrototypeOf(e,a.prototype),e}function a(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return C(r)}return U(r,e,t)}a.poolSize=8192;function U(r,e,t){if(typeof r=="string")return $(r,e);if(ArrayBuffer.isView(r))return _(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(X(r,ArrayBuffer)||r&&X(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(X(r,SharedArrayBuffer)||r&&X(r.buffer,SharedArrayBuffer)))return p(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const s=r.valueOf&&r.valueOf();if(s!=null&&s!==r)return a.from(s,e,t);const c=g(r);if(c)return c;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return a.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}a.from=function(r,e,t){return U(r,e,t)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function M(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function h(r,e,t){return M(r),r<=0?A(r):e!==void 0?typeof t=="string"?A(r).fill(e,t):A(r).fill(e):A(r)}a.alloc=function(r,e,t){return h(r,e,t)};function C(r){return M(r),A(r<0?0:m(r)|0)}a.allocUnsafe=function(r){return C(r)},a.allocUnsafeSlow=function(r){return C(r)};function $(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!a.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const t=E(r,e)|0;let s=A(t);const c=s.write(r,e);return c!==t&&(s=s.slice(0,c)),s}function b(r){const e=r.length<0?0:m(r.length)|0,t=A(e);for(let s=0;s<e;s+=1)t[s]=r[s]&255;return t}function _(r){if(X(r,Uint8Array)){const e=new Uint8Array(r);return p(e.buffer,e.byteOffset,e.byteLength)}return b(r)}function p(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let s;return e===void 0&&t===void 0?s=new Uint8Array(r):t===void 0?s=new Uint8Array(r,e):s=new Uint8Array(r,e,t),Object.setPrototypeOf(s,a.prototype),s}function g(r){if(a.isBuffer(r)){const e=m(r.length)|0,t=A(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||Fe(r.length)?A(0):b(r);if(r.type==="Buffer"&&Array.isArray(r.data))return b(r.data)}function m(r){if(r>=y)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+y.toString(16)+" bytes");return r|0}function d(r){return+r!=r&&(r=0),a.alloc(+r)}a.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==a.prototype},a.compare=function(e,t){if(X(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),X(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(e)||!a.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let s=e.length,c=t.length;for(let l=0,f=Math.min(s,c);l<f;++l)if(e[l]!==t[l]){s=e[l],c=t[l];break}return s<c?-1:c<s?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return a.alloc(0);let s;if(t===void 0)for(t=0,s=0;s<e.length;++s)t+=e[s].length;const c=a.allocUnsafe(t);let l=0;for(s=0;s<e.length;++s){let f=e[s];if(X(f,Uint8Array))l+f.length>c.length?(a.isBuffer(f)||(f=a.from(f)),f.copy(c,l)):Uint8Array.prototype.set.call(c,f,l);else if(a.isBuffer(f))f.copy(c,l);else throw new TypeError('"list" argument must be an Array of Buffers');l+=f.length}return c};function E(r,e){if(a.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||X(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);const t=r.length,s=arguments.length>2&&arguments[2]===!0;if(!s&&t===0)return 0;let c=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return Be(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return et(r).length;default:if(c)return s?-1:Be(r).length;e=(""+e).toLowerCase(),c=!0}}a.byteLength=E;function B(r,e,t){let s=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return oe(this,e,t);case"utf8":case"utf-8":return G(this,e,t);case"ascii":return z(this,e,t);case"latin1":case"binary":return J(this,e,t);case"base64":return S(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return vr(this,e,t);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),s=!0}}a.prototype._isBuffer=!0;function T(r,e,t){const s=r[e];r[e]=r[t],r[t]=s}a.prototype.swap16=function(){const e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)T(this,t,t+1);return this},a.prototype.swap32=function(){const e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)T(this,t,t+3),T(this,t+1,t+2);return this},a.prototype.swap64=function(){const e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)T(this,t,t+7),T(this,t+1,t+6),T(this,t+2,t+5),T(this,t+3,t+4);return this},a.prototype.toString=function(){const e=this.length;return e===0?"":arguments.length===0?G(this,0,e):B.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:a.compare(this,e)===0},a.prototype.inspect=function(){let e="";const t=i.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},u&&(a.prototype[u]=a.prototype.inspect),a.prototype.compare=function(e,t,s,c,l){if(X(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),s===void 0&&(s=e?e.length:0),c===void 0&&(c=0),l===void 0&&(l=this.length),t<0||s>e.length||c<0||l>this.length)throw new RangeError("out of range index");if(c>=l&&t>=s)return 0;if(c>=l)return-1;if(t>=s)return 1;if(t>>>=0,s>>>=0,c>>>=0,l>>>=0,this===e)return 0;let f=l-c,v=s-t;const j=Math.min(f,v),O=this.slice(c,l),q=e.slice(t,s);for(let N=0;N<j;++N)if(O[N]!==q[N]){f=O[N],v=q[N];break}return f<v?-1:v<f?1:0};function x(r,e,t,s,c){if(r.length===0)return-1;if(typeof t=="string"?(s=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,Fe(t)&&(t=c?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(c)return-1;t=r.length-1}else if(t<0)if(c)t=0;else return-1;if(typeof e=="string"&&(e=a.from(e,s)),a.isBuffer(e))return e.length===0?-1:I(r,e,t,s,c);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?c?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):I(r,[e],t,s,c);throw new TypeError("val must be string, number or Buffer")}function I(r,e,t,s,c){let l=1,f=r.length,v=e.length;if(s!==void 0&&(s=String(s).toLowerCase(),s==="ucs2"||s==="ucs-2"||s==="utf16le"||s==="utf-16le")){if(r.length<2||e.length<2)return-1;l=2,f/=2,v/=2,t/=2}function j(q,N){return l===1?q[N]:q.readUInt16BE(N*l)}let O;if(c){let q=-1;for(O=t;O<f;O++)if(j(r,O)===j(e,q===-1?0:O-q)){if(q===-1&&(q=O),O-q+1===v)return q*l}else q!==-1&&(O-=O-q),q=-1}else for(t+v>f&&(t=f-v),O=t;O>=0;O--){let q=!0;for(let N=0;N<v;N++)if(j(r,O+N)!==j(e,N)){q=!1;break}if(q)return O}return-1}a.prototype.includes=function(e,t,s){return this.indexOf(e,t,s)!==-1},a.prototype.indexOf=function(e,t,s){return x(this,e,t,s,!0)},a.prototype.lastIndexOf=function(e,t,s){return x(this,e,t,s,!1)};function F(r,e,t,s){t=Number(t)||0;const c=r.length-t;s?(s=Number(s),s>c&&(s=c)):s=c;const l=e.length;s>l/2&&(s=l/2);let f;for(f=0;f<s;++f){const v=parseInt(e.substr(f*2,2),16);if(Fe(v))return f;r[t+f]=v}return f}function R(r,e,t,s){return de(Be(e,r.length-t),r,t,s)}function k(r,e,t,s){return de($r(e),r,t,s)}function D(r,e,t,s){return de(et(e),r,t,s)}function V(r,e,t,s){return de(Or(e,r.length-t),r,t,s)}a.prototype.write=function(e,t,s,c){if(t===void 0)c="utf8",s=this.length,t=0;else if(s===void 0&&typeof t=="string")c=t,s=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(s)?(s=s>>>0,c===void 0&&(c="utf8")):(c=s,s=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const l=this.length-t;if((s===void 0||s>l)&&(s=l),e.length>0&&(s<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");c||(c="utf8");let f=!1;for(;;)switch(c){case"hex":return F(this,e,t,s);case"utf8":case"utf-8":return R(this,e,t,s);case"ascii":case"latin1":case"binary":return k(this,e,t,s);case"base64":return D(this,e,t,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return V(this,e,t,s);default:if(f)throw new TypeError("Unknown encoding: "+c);c=(""+c).toLowerCase(),f=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function S(r,e,t){return e===0&&t===r.length?n.fromByteArray(r):n.fromByteArray(r.slice(e,t))}function G(r,e,t){t=Math.min(r.length,t);const s=[];let c=e;for(;c<t;){const l=r[c];let f=null,v=l>239?4:l>223?3:l>191?2:1;if(c+v<=t){let j,O,q,N;switch(v){case 1:l<128&&(f=l);break;case 2:j=r[c+1],(j&192)===128&&(N=(l&31)<<6|j&63,N>127&&(f=N));break;case 3:j=r[c+1],O=r[c+2],(j&192)===128&&(O&192)===128&&(N=(l&15)<<12|(j&63)<<6|O&63,N>2047&&(N<55296||N>57343)&&(f=N));break;case 4:j=r[c+1],O=r[c+2],q=r[c+3],(j&192)===128&&(O&192)===128&&(q&192)===128&&(N=(l&15)<<18|(j&63)<<12|(O&63)<<6|q&63,N>65535&&N<1114112&&(f=N))}}f===null?(f=65533,v=1):f>65535&&(f-=65536,s.push(f>>>10&1023|55296),f=56320|f&1023),s.push(f),c+=v}return Y(s)}const P=4096;function Y(r){const e=r.length;if(e<=P)return String.fromCharCode.apply(String,r);let t="",s=0;for(;s<e;)t+=String.fromCharCode.apply(String,r.slice(s,s+=P));return t}function z(r,e,t){let s="";t=Math.min(r.length,t);for(let c=e;c<t;++c)s+=String.fromCharCode(r[c]&127);return s}function J(r,e,t){let s="";t=Math.min(r.length,t);for(let c=e;c<t;++c)s+=String.fromCharCode(r[c]);return s}function oe(r,e,t){const s=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>s)&&(t=s);let c="";for(let l=e;l<t;++l)c+=Dr[r[l]];return c}function vr(r,e,t){const s=r.slice(e,t);let c="";for(let l=0;l<s.length-1;l+=2)c+=String.fromCharCode(s[l]+s[l+1]*256);return c}a.prototype.slice=function(e,t){const s=this.length;e=~~e,t=t===void 0?s:~~t,e<0?(e+=s,e<0&&(e=0)):e>s&&(e=s),t<0?(t+=s,t<0&&(t=0)):t>s&&(t=s),t<e&&(t=e);const c=this.subarray(e,t);return Object.setPrototypeOf(c,a.prototype),c};function K(r,e,t){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(e,t,s){e=e>>>0,t=t>>>0,s||K(e,t,this.length);let c=this[e],l=1,f=0;for(;++f<t&&(l*=256);)c+=this[e+f]*l;return c},a.prototype.readUintBE=a.prototype.readUIntBE=function(e,t,s){e=e>>>0,t=t>>>0,s||K(e,t,this.length);let c=this[e+--t],l=1;for(;t>0&&(l*=256);)c+=this[e+--t]*l;return c},a.prototype.readUint8=a.prototype.readUInt8=function(e,t){return e=e>>>0,t||K(e,1,this.length),this[e]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||K(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||K(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||K(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||K(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readBigUInt64LE=ee(function(e){e=e>>>0,ne(e,"offset");const t=this[e],s=this[e+7];(t===void 0||s===void 0)&&ae(e,this.length-8);const c=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,l=this[++e]+this[++e]*2**8+this[++e]*2**16+s*2**24;return BigInt(c)+(BigInt(l)<<BigInt(32))}),a.prototype.readBigUInt64BE=ee(function(e){e=e>>>0,ne(e,"offset");const t=this[e],s=this[e+7];(t===void 0||s===void 0)&&ae(e,this.length-8);const c=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],l=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+s;return(BigInt(c)<<BigInt(32))+BigInt(l)}),a.prototype.readIntLE=function(e,t,s){e=e>>>0,t=t>>>0,s||K(e,t,this.length);let c=this[e],l=1,f=0;for(;++f<t&&(l*=256);)c+=this[e+f]*l;return l*=128,c>=l&&(c-=Math.pow(2,8*t)),c},a.prototype.readIntBE=function(e,t,s){e=e>>>0,t=t>>>0,s||K(e,t,this.length);let c=t,l=1,f=this[e+--c];for(;c>0&&(l*=256);)f+=this[e+--c]*l;return l*=128,f>=l&&(f-=Math.pow(2,8*t)),f},a.prototype.readInt8=function(e,t){return e=e>>>0,t||K(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]},a.prototype.readInt16LE=function(e,t){e=e>>>0,t||K(e,2,this.length);const s=this[e]|this[e+1]<<8;return s&32768?s|4294901760:s},a.prototype.readInt16BE=function(e,t){e=e>>>0,t||K(e,2,this.length);const s=this[e+1]|this[e]<<8;return s&32768?s|4294901760:s},a.prototype.readInt32LE=function(e,t){return e=e>>>0,t||K(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return e=e>>>0,t||K(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readBigInt64LE=ee(function(e){e=e>>>0,ne(e,"offset");const t=this[e],s=this[e+7];(t===void 0||s===void 0)&&ae(e,this.length-8);const c=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(s<<24);return(BigInt(c)<<BigInt(32))+BigInt(t+this[++e]*256+this[++e]*65536+this[++e]*16777216)}),a.prototype.readBigInt64BE=ee(function(e){e=e>>>0,ne(e,"offset");const t=this[e],s=this[e+7];(t===void 0||s===void 0)&&ae(e,this.length-8);const c=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(c)<<BigInt(32))+BigInt(this[++e]*16777216+this[++e]*65536+this[++e]*256+s)}),a.prototype.readFloatLE=function(e,t){return e=e>>>0,t||K(e,4,this.length),o.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return e=e>>>0,t||K(e,4,this.length),o.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||K(e,8,this.length),o.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||K(e,8,this.length),o.read(this,e,!1,52,8)};function H(r,e,t,s,c,l){if(!a.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>c||e<l)throw new RangeError('"value" argument is out of bounds');if(t+s>r.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(e,t,s,c){if(e=+e,t=t>>>0,s=s>>>0,!c){const v=Math.pow(2,8*s)-1;H(this,e,t,s,v,0)}let l=1,f=0;for(this[t]=e&255;++f<s&&(l*=256);)this[t+f]=e/l&255;return t+s},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(e,t,s,c){if(e=+e,t=t>>>0,s=s>>>0,!c){const v=Math.pow(2,8*s)-1;H(this,e,t,s,v,0)}let l=s-1,f=1;for(this[t+l]=e&255;--l>=0&&(f*=256);)this[t+l]=e/f&255;return t+s},a.prototype.writeUint8=a.prototype.writeUInt8=function(e,t,s){return e=+e,t=t>>>0,s||H(this,e,t,1,255,0),this[t]=e&255,t+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(e,t,s){return e=+e,t=t>>>0,s||H(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(e,t,s){return e=+e,t=t>>>0,s||H(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(e,t,s){return e=+e,t=t>>>0,s||H(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(e,t,s){return e=+e,t=t>>>0,s||H(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function Je(r,e,t,s,c){Ze(e,s,c,r,t,7);let l=Number(e&BigInt(4294967295));r[t++]=l,l=l>>8,r[t++]=l,l=l>>8,r[t++]=l,l=l>>8,r[t++]=l;let f=Number(e>>BigInt(32)&BigInt(4294967295));return r[t++]=f,f=f>>8,r[t++]=f,f=f>>8,r[t++]=f,f=f>>8,r[t++]=f,t}function He(r,e,t,s,c){Ze(e,s,c,r,t,7);let l=Number(e&BigInt(4294967295));r[t+7]=l,l=l>>8,r[t+6]=l,l=l>>8,r[t+5]=l,l=l>>8,r[t+4]=l;let f=Number(e>>BigInt(32)&BigInt(4294967295));return r[t+3]=f,f=f>>8,r[t+2]=f,f=f>>8,r[t+1]=f,f=f>>8,r[t]=f,t+8}a.prototype.writeBigUInt64LE=ee(function(e,t=0){return Je(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeBigUInt64BE=ee(function(e,t=0){return He(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),a.prototype.writeIntLE=function(e,t,s,c){if(e=+e,t=t>>>0,!c){const j=Math.pow(2,8*s-1);H(this,e,t,s,j-1,-j)}let l=0,f=1,v=0;for(this[t]=e&255;++l<s&&(f*=256);)e<0&&v===0&&this[t+l-1]!==0&&(v=1),this[t+l]=(e/f>>0)-v&255;return t+s},a.prototype.writeIntBE=function(e,t,s,c){if(e=+e,t=t>>>0,!c){const j=Math.pow(2,8*s-1);H(this,e,t,s,j-1,-j)}let l=s-1,f=1,v=0;for(this[t+l]=e&255;--l>=0&&(f*=256);)e<0&&v===0&&this[t+l+1]!==0&&(v=1),this[t+l]=(e/f>>0)-v&255;return t+s},a.prototype.writeInt8=function(e,t,s){return e=+e,t=t>>>0,s||H(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1},a.prototype.writeInt16LE=function(e,t,s){return e=+e,t=t>>>0,s||H(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2},a.prototype.writeInt16BE=function(e,t,s){return e=+e,t=t>>>0,s||H(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2},a.prototype.writeInt32LE=function(e,t,s){return e=+e,t=t>>>0,s||H(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},a.prototype.writeInt32BE=function(e,t,s){return e=+e,t=t>>>0,s||H(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4},a.prototype.writeBigInt64LE=ee(function(e,t=0){return Je(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),a.prototype.writeBigInt64BE=ee(function(e,t=0){return He(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Qe(r,e,t,s,c,l){if(t+s>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function Ye(r,e,t,s,c){return e=+e,t=t>>>0,c||Qe(r,e,t,4),o.write(r,e,t,s,23,4),t+4}a.prototype.writeFloatLE=function(e,t,s){return Ye(this,e,t,!0,s)},a.prototype.writeFloatBE=function(e,t,s){return Ye(this,e,t,!1,s)};function ze(r,e,t,s,c){return e=+e,t=t>>>0,c||Qe(r,e,t,8),o.write(r,e,t,s,52,8),t+8}a.prototype.writeDoubleLE=function(e,t,s){return ze(this,e,t,!0,s)},a.prototype.writeDoubleBE=function(e,t,s){return ze(this,e,t,!1,s)},a.prototype.copy=function(e,t,s,c){if(!a.isBuffer(e))throw new TypeError("argument should be a Buffer");if(s||(s=0),!c&&c!==0&&(c=this.length),t>=e.length&&(t=e.length),t||(t=0),c>0&&c<s&&(c=s),c===s||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(s<0||s>=this.length)throw new RangeError("Index out of range");if(c<0)throw new RangeError("sourceEnd out of bounds");c>this.length&&(c=this.length),e.length-t<c-s&&(c=e.length-t+s);const l=c-s;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,s,c):Uint8Array.prototype.set.call(e,this.subarray(s,c),t),l},a.prototype.fill=function(e,t,s,c){if(typeof e=="string"){if(typeof t=="string"?(c=t,t=0,s=this.length):typeof s=="string"&&(c=s,s=this.length),c!==void 0&&typeof c!="string")throw new TypeError("encoding must be a string");if(typeof c=="string"&&!a.isEncoding(c))throw new TypeError("Unknown encoding: "+c);if(e.length===1){const f=e.charCodeAt(0);(c==="utf8"&&f<128||c==="latin1")&&(e=f)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<s)throw new RangeError("Out of range index");if(s<=t)return this;t=t>>>0,s=s===void 0?this.length:s>>>0,e||(e=0);let l;if(typeof e=="number")for(l=t;l<s;++l)this[l]=e;else{const f=a.isBuffer(e)?e:a.from(e,c),v=f.length;if(v===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(l=0;l<s-t;++l)this[l+t]=f[l%v]}return this};const re={};function Ie(r,e,t){re[r]=class extends t{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(c){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:c,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}Ie("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Ie("ERR_INVALID_ARG_TYPE",function(r,e){return`The "${r}" argument must be of type number. Received type ${typeof e}`},TypeError),Ie("ERR_OUT_OF_RANGE",function(r,e,t){let s=`The value of "${r}" is out of range.`,c=t;return Number.isInteger(t)&&Math.abs(t)>4294967296?c=Xe(String(t)):typeof t=="bigint"&&(c=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(c=Xe(c)),c+="n"),s+=` It must be ${e}. Received ${c}`,s},RangeError);function Xe(r){let e="",t=r.length;const s=r[0]==="-"?1:0;for(;t>=s+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}function Lr(r,e,t){ne(e,"offset"),(r[e]===void 0||r[e+t]===void 0)&&ae(e,r.length-(t+1))}function Ze(r,e,t,s,c,l){if(r>t||r<e){const f=typeof e=="bigint"?"n":"";let v;throw e===0||e===BigInt(0)?v=`>= 0${f} and < 2${f} ** ${(l+1)*8}${f}`:v=`>= -(2${f} ** ${(l+1)*8-1}${f}) and < 2 ** ${(l+1)*8-1}${f}`,new re.ERR_OUT_OF_RANGE("value",v,r)}Lr(s,c,l)}function ne(r,e){if(typeof r!="number")throw new re.ERR_INVALID_ARG_TYPE(e,"number",r)}function ae(r,e,t){throw Math.floor(r)!==r?(ne(r,t),new re.ERR_OUT_OF_RANGE("offset","an integer",r)):e<0?new re.ERR_BUFFER_OUT_OF_BOUNDS:new re.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${e}`,r)}const Pr=/[^+/0-9A-Za-z-_]/g;function Nr(r){if(r=r.split("=")[0],r=r.trim().replace(Pr,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function Be(r,e){e=e||1/0;let t;const s=r.length;let c=null;const l=[];for(let f=0;f<s;++f){if(t=r.charCodeAt(f),t>55295&&t<57344){if(!c){if(t>56319){(e-=3)>-1&&l.push(239,191,189);continue}else if(f+1===s){(e-=3)>-1&&l.push(239,191,189);continue}c=t;continue}if(t<56320){(e-=3)>-1&&l.push(239,191,189),c=t;continue}t=(c-55296<<10|t-56320)+65536}else c&&(e-=3)>-1&&l.push(239,191,189);if(c=null,t<128){if((e-=1)<0)break;l.push(t)}else if(t<2048){if((e-=2)<0)break;l.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;l.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;l.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return l}function $r(r){const e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function Or(r,e){let t,s,c;const l=[];for(let f=0;f<r.length&&!((e-=2)<0);++f)t=r.charCodeAt(f),s=t>>8,c=t%256,l.push(c),l.push(s);return l}function et(r){return n.toByteArray(Nr(r))}function de(r,e,t,s){let c;for(c=0;c<s&&!(c+t>=e.length||c>=r.length);++c)e[c+t]=r[c];return c}function X(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}function Fe(r){return r!==r}const Dr=function(){const r="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){const s=t*16;for(let c=0;c<16;++c)e[s+c]=r[t]+r[c]}return e}();function ee(r){return typeof BigInt>"u"?jr:r}function jr(){throw new Error("BigInt not supported")}}(we)),we}var yt=dt();class se{static loop(n,o){"v".repeat(n).split("").map((u,y)=>o(y))}}class L{static get(n){return n>>>0}static xor(n,o){return this.get(this.get(n)^this.get(o))}static and(n,o){return this.get(this.get(n)&this.get(o))}static mul(n,o){const u=((n&4294901760)>>>0)*o,y=(n&65535)*o;return this.get((u>>>0)+(y>>>0))}static or(n,o){return this.get(this.get(n)|this.get(o))}static not(n){return this.get(~this.get(n))}static shiftLeft(n,o){return this.get(this.get(n)<<o)}static shiftRight(n,o){return this.get(n)>>>o}static mod(n,o){return this.get(this.get(n)%o)}}const wt=8,At=8,Me=1,xt=10,Et=8,ve=2147483647;class bt{constructor(){this.status=[],this.mat1=0,this.mat2=0,this.tmat=0}seed(n){se.loop(4,o=>{n.length>o?this.status[o]=L.get(n.charAt(o).charCodeAt()):this.status[o]=L.get(110)}),[,this.mat1,this.mat2,this.tmat]=this.status,this.init()}init(){se.loop(wt-1,n=>{this.status[n+1&3]=L.xor(this.status[n+1&3],n+1+L.mul(1812433253,L.xor(this.status[n&3],L.shiftRight(this.status[n&3],30))))}),(this.status[0]&ve)===0&&this.status[1]===0&&this.status[2]===0&&this.status[3]===0&&(this.status[0]=66,this.status[1]=65,this.status[2]=89,this.status[3]=83),se.loop(At,()=>this.nextState())}nextState(){let n,o;[,,,o]=this.status,n=L.xor(L.and(this.status[0],ve),L.xor(this.status[1],this.status[2])),n=L.xor(n,L.shiftLeft(n,Me)),o=L.xor(o,L.xor(L.shiftRight(o,Me),n)),[,this.status[0],this.status[1]]=this.status,this.status[2]=L.xor(n,L.shiftLeft(o,xt)),this.status[3]=o,this.status[1]=L.xor(this.status[1],L.and(-L.and(o,1),this.mat1)),this.status[2]=L.xor(this.status[2],L.and(-L.and(o,1),this.mat2))}generate(n){this.nextState();let o;[,,,o]=this.status;const u=L.xor(this.status[0],L.shiftRight(this.status[2],Et));return o=L.xor(o,u),o=L.xor(L.and(-L.and(u,1),this.tmat),o),o%n}}class Le{constructor(){this.char=".",this.children={}}getChar(){return this.char}getChildren(){return this.children}setChar(n){this.char=n}setChildren(n,o){this.children[n]=o}}const Pe="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",It="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Bt=[1,2,2,2,2,2];class Ft{constructor(){this.random=new bt,this.sign="",this.inter={},this.head=new Le}init(n){this.random.seed(n),this.sign=n,se.loop(64,o=>{this.addSymbol(It[o],Bt[Number.parseInt((o+1)/11,10)])}),this.inter["="]="="}addSymbol(n,o){let u=this.head,y="";return se.loop(o,()=>{let w=Pe[this.random.generate(32)];for(;w in u.getChildren()&&u.getChildren()[w].getChar()!==".";)w=Pe[this.random.generate(32)];y+=w,w in u.getChildren()||u.setChildren(w,new Le),u=u.getChildren()[w]}),u.setChar(n),this.inter[n]=y,y}decode(n){let o="";for(let u=4;u<n.length;){if(n[u]==="="){o+="=",u++;continue}let y=this.head;for(;n[u]in y.getChildren();)y=y.getChildren()[n[u]],u++;o+=y.getChar()}return o}}function fe(i){const n=i.charCodeAt();return n>=65?n-65:n-65+41}const _t=1;function Tt(i){const n=fe(i[0])*32+fe(i[1]),o=fe(i[2]),u=fe(i[3]);return _t>=(n*o+u)%32}function Rt(i){if(!Tt(i))return"";const n=new Ft;n.init(i.substr(0,4));const o=n.decode(i);return yt.Buffer.from(o,"base64").toString("utf8")}const Ct=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,St=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,kt=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function Ut(i,n){if(i==="__proto__"||i==="constructor"&&n&&typeof n=="object"&&"prototype"in n){Mt(i);return}return n}function Mt(i){console.warn(`[destr] Dropping "${i}" key to prevent prototype pollution.`)}function vt(i,n={}){if(typeof i!="string")return i;if(i[0]==='"'&&i[i.length-1]==='"'&&i.indexOf("\\")===-1)return i.slice(1,-1);const o=i.trim();if(o.length<=9)switch(o.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!kt.test(i)){if(n.strict)throw new SyntaxError("[destr] Invalid JSON");return i}try{if(Ct.test(i)||St.test(i)){if(n.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(i,Ut)}return JSON.parse(i)}catch(u){if(n.strict)throw u;return i}}const Lt=/#/g,Pt=/&/g,Nt=/\//g,$t=/=/g,Ae=/\+/g,Ot=/%5e/gi,Dt=/%60/gi,jt=/%7c/gi,qt=/%20/gi;function Vt(i){return encodeURI(""+i).replace(jt,"|")}function xe(i){return Vt(typeof i=="string"?i:JSON.stringify(i)).replace(Ae,"%2B").replace(qt,"+").replace(Lt,"%23").replace(Pt,"%26").replace(Dt,"`").replace(Ot,"^").replace(Nt,"%2F")}function Ee(i){return xe(i).replace($t,"%3D")}function Ne(i=""){try{return decodeURIComponent(""+i)}catch{return""+i}}function Wt(i){return Ne(i.replace(Ae," "))}function Kt(i){return Ne(i.replace(Ae," "))}function Gt(i=""){const n=Object.create(null);i[0]==="?"&&(i=i.slice(1));for(const o of i.split("&")){const u=o.match(/([^=]+)=?(.*)/)||[];if(u.length<2)continue;const y=Wt(u[1]);if(y==="__proto__"||y==="constructor")continue;const w=Kt(u[2]||"");n[y]===void 0?n[y]=w:Array.isArray(n[y])?n[y].push(w):n[y]=[n[y],w]}return n}function Jt(i,n){return(typeof n=="number"||typeof n=="boolean")&&(n=String(n)),n?Array.isArray(n)?n.map(o=>`${Ee(i)}=${xe(o)}`).join("&"):`${Ee(i)}=${xe(n)}`:Ee(i)}function Ht(i){return Object.keys(i).filter(n=>i[n]!==void 0).map(n=>Jt(n,i[n])).filter(Boolean).join("&")}const Qt=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,Yt=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,zt=/^([/\\]\s*){2,}[^/\\]/,Xt=/^\.?\//;function $e(i,n={}){return typeof n=="boolean"&&(n={acceptRelative:n}),n.strict?Qt.test(i):Yt.test(i)||(n.acceptRelative?zt.test(i):!1)}function Zt(i="",n){return i.endsWith("/")}function er(i="",n){return(Zt(i)?i.slice(0,-1):i)||"/"}function tr(i="",n){return i.endsWith("/")?i:i+"/"}function rr(i,n){if(ir(n)||$e(i))return i;const o=er(n);return i.startsWith(o)?i:or(o,i)}function nr(i,n){const o=ar(i),u={...Gt(o.search),...n};return o.search=Ht(u),cr(o)}function ir(i){return!i||i==="/"}function sr(i){return i&&i!=="/"}function or(i,...n){let o=i||"";for(const u of n.filter(y=>sr(y)))if(o){const y=u.replace(Xt,"");o=tr(o)+y}else o=u;return o}const Oe=Symbol.for("ufo:protocolRelative");function ar(i="",n){const o=i.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/i);if(o){const[,C,$=""]=o;return{protocol:C.toLowerCase(),pathname:$,href:C+$,auth:"",host:"",search:"",hash:""}}if(!$e(i,{acceptRelative:!0}))return De(i);const[,u="",y,w=""]=i.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[];let[,A="",a=""]=w.match(/([^#/?]*)(.*)?/)||[];u==="file:"&&(a=a.replace(/\/(?=[A-Za-z]:)/,""));const{pathname:U,search:M,hash:h}=De(a);return{protocol:u.toLowerCase(),auth:y?y.slice(0,Math.max(0,y.length-1)):"",host:A,pathname:U,search:M,hash:h,[Oe]:!u}}function De(i=""){const[n="",o="",u=""]=(i.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:n,search:o,hash:u}}function cr(i){const n=i.pathname||"",o=i.search?(i.search.startsWith("?")?"":"?")+i.search:"",u=i.hash||"",y=i.auth?i.auth+"@":"",w=i.host||"";return(i.protocol||i[Oe]?(i.protocol||"")+"//":"")+y+w+n+o+u}class ur extends Error{constructor(n,o){super(n,o),this.name="FetchError",o!=null&&o.cause&&!this.cause&&(this.cause=o.cause)}}function lr(i){var U,M,h,C,$;const n=((U=i.error)==null?void 0:U.message)||((M=i.error)==null?void 0:M.toString())||"",o=((h=i.request)==null?void 0:h.method)||((C=i.options)==null?void 0:C.method)||"GET",u=(($=i.request)==null?void 0:$.url)||String(i.request)||"/",y=`[${o}] ${JSON.stringify(u)}`,w=i.response?`${i.response.status} ${i.response.statusText}`:"<no response>",A=`${y}: ${w}${n?` ${n}`:""}`,a=new ur(A,i.error?{cause:i.error}:void 0);for(const b of["request","options","response"])Object.defineProperty(a,b,{get(){return i[b]}});for(const[b,_]of[["data","_data"],["status","status"],["statusCode","status"],["statusText","statusText"],["statusMessage","statusText"]])Object.defineProperty(a,b,{get(){return i.response&&i.response[_]}});return a}const hr=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function je(i="GET"){return hr.has(i.toUpperCase())}function fr(i){if(i===void 0)return!1;const n=typeof i;return n==="string"||n==="number"||n==="boolean"||n===null?!0:n!=="object"?!1:Array.isArray(i)?!0:i.buffer?!1:i.constructor&&i.constructor.name==="Object"||typeof i.toJSON=="function"}const gr=new Set(["image/svg","application/xml","application/xhtml","application/html"]),mr=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function pr(i=""){if(!i)return"json";const n=i.split(";").shift()||"";return mr.test(n)?"json":gr.has(n)||n.startsWith("text/")?"text":"blob"}function dr(i,n,o,u){const y=yr((n==null?void 0:n.headers)??(i==null?void 0:i.headers),o==null?void 0:o.headers,u);let w;return(o!=null&&o.query||o!=null&&o.params||n!=null&&n.params||n!=null&&n.query)&&(w={...o==null?void 0:o.params,...o==null?void 0:o.query,...n==null?void 0:n.params,...n==null?void 0:n.query}),{...o,...n,query:w,params:w,headers:y}}function yr(i,n,o){if(!n)return new o(i);const u=new o(n);if(i)for(const[y,w]of Symbol.iterator in i||Array.isArray(i)?i:new o(i))u.set(y,w);return u}async function ge(i,n){if(n)if(Array.isArray(n))for(const o of n)await o(i);else await n(i)}const wr=new Set([408,409,425,429,500,502,503,504]),Ar=new Set([101,204,205,304]);function qe(i={}){const{fetch:n=globalThis.fetch,Headers:o=globalThis.Headers,AbortController:u=globalThis.AbortController}=i;async function y(a){const U=a.error&&a.error.name==="AbortError"&&!a.options.timeout||!1;if(a.options.retry!==!1&&!U){let h;typeof a.options.retry=="number"?h=a.options.retry:h=je(a.options.method)?0:1;const C=a.response&&a.response.status||500;if(h>0&&(Array.isArray(a.options.retryStatusCodes)?a.options.retryStatusCodes.includes(C):wr.has(C))){const $=typeof a.options.retryDelay=="function"?a.options.retryDelay(a):a.options.retryDelay||0;return $>0&&await new Promise(b=>setTimeout(b,$)),w(a.request,{...a.options,retry:h-1})}}const M=lr(a);throw Error.captureStackTrace&&Error.captureStackTrace(M,w),M}const w=async function(U,M={}){const h={request:U,options:dr(U,M,i.defaults,o),response:void 0,error:void 0};h.options.method&&(h.options.method=h.options.method.toUpperCase()),h.options.onRequest&&await ge(h,h.options.onRequest),typeof h.request=="string"&&(h.options.baseURL&&(h.request=rr(h.request,h.options.baseURL)),h.options.query&&(h.request=nr(h.request,h.options.query),delete h.options.query),"query"in h.options&&delete h.options.query,"params"in h.options&&delete h.options.params),h.options.body&&je(h.options.method)&&(fr(h.options.body)?(h.options.body=typeof h.options.body=="string"?h.options.body:JSON.stringify(h.options.body),h.options.headers=new o(h.options.headers||{}),h.options.headers.has("content-type")||h.options.headers.set("content-type","application/json"),h.options.headers.has("accept")||h.options.headers.set("accept","application/json")):("pipeTo"in h.options.body&&typeof h.options.body.pipeTo=="function"||typeof h.options.body.pipe=="function")&&("duplex"in h.options||(h.options.duplex="half")));let C;if(!h.options.signal&&h.options.timeout){const b=new u;C=setTimeout(()=>{const _=new Error("[TimeoutError]: The operation was aborted due to timeout");_.name="TimeoutError",_.code=23,b.abort(_)},h.options.timeout),h.options.signal=b.signal}try{h.response=await n(h.request,h.options)}catch(b){return h.error=b,h.options.onRequestError&&await ge(h,h.options.onRequestError),await y(h)}finally{C&&clearTimeout(C)}if((h.response.body||h.response._bodyInit)&&!Ar.has(h.response.status)&&h.options.method!=="HEAD"){const b=(h.options.parseResponse?"json":h.options.responseType)||pr(h.response.headers.get("content-type")||"");switch(b){case"json":{const _=await h.response.text(),p=h.options.parseResponse||vt;h.response._data=p(_);break}case"stream":{h.response._data=h.response.body||h.response._bodyInit;break}default:h.response._data=await h.response[b]()}}return h.options.onResponse&&await ge(h,h.options.onResponse),!h.options.ignoreResponseError&&h.response.status>=400&&h.response.status<600?(h.options.onResponseError&&await ge(h,h.options.onResponseError),await y(h)):h.response},A=async function(U,M){return(await w(U,M))._data};return A.raw=w,A.native=(...a)=>n(...a),A.create=(a={},U={})=>qe({...i,...U,defaults:{...i.defaults,...U.defaults,...a}}),A}const me=function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}(),xr=me.fetch?(...i)=>me.fetch(...i):()=>Promise.reject(new Error("[ofetch] global.fetch is not supported!")),Er=me.Headers,br=me.AbortController,te=qe({fetch:xr,Headers:Er,AbortController:br}),Ir=["shanbay.com","hjenglish.com","codepen.io","jsfiddle.net","jsbin.com","codesandbox.io","github1s.com"];var Z=(i=>(i.AddOrForget="AddOrForget",i.Collins="Collins",i.DailyTask="DailyTask",i.ForwardAudio="ForwardAudio",i.GetAuthInfo="GetAuthInfo",i.GetWordExample="GetWordExample",i.Lookup="Lookup",i.LookupClicked="LookupClicked",i.PlayAudio="PlayAudio",i))(Z||{});let Q={};const Br=tt(()=>{W.runtime.onMessage.addListener((n,o,u)=>{switch(n.action){case Z.Collins:return Fr(n);case Z.GetAuthInfo:return _r();case Z.Lookup:return Tr(n);case Z.GetWordExample:return Sr(n);case Z.AddOrForget:return Cr(n);case Z.ForwardAudio:return Ur(n)}return!0}),Ce.getItem("local:__shanbayExtensionSettings").then(n=>{Q=n});const i=Ce.watch("local:__shanbayExtensionSettings",n=>{Q=n,Ve()});W.runtime.onInstalled.addListener(()=>{Ve()}),W.runtime.onSuspend.addListener(()=>{i()}),W.runtime.onInstalled.addListener(()=>{W.contextMenus.create({contexts:["selection"],id:"shanbay-lookup",title:"在扇贝网中查找 %s"})}),W.contextMenus.onClicked.addListener(async(n,o)=>{var w;const u=o==null?void 0:o.url;let y=!1;Ir.some(A=>We(u,A))?y=!0:y=!1,Q&&Q.ignoreSites&&Q.ignoreSites.some(A=>We(u,A))?y=!0:y=!1,W.tabs.sendMessage(o.id,{action:Z.LookupClicked,data:{ignored:y,word:(w=n.selectionText)==null?void 0:w.trim()}})}),W.offscreen.createDocument({justification:"<your justification here>",reasons:["CLIPBOARD"],url:"/offscreen.html"})});async function Fr(i){const n=`https://dict.youdao.com/w/${i.word}`;try{return await te(n,{mode:"no-cors",parseResponse:u=>u})}catch{return null}}async function _r(){return(await W.cookies.getAll({domain:"shanbay.com",name:"auth_token"}))[0]}async function Tr(i){const n=`https://apiv3.shanbay.com/abc/words/senses?vocabulary_content=${i.word}`;try{const o=await te(n,{credentials:"include",mode:"cors",parseResponse:JSON.parse}),u=await Rr(o.id);return o.exists=u.data.objects[0].exists,{data:o,msg:"success",status:200}}catch(o){const u=o;return{data:u.data,msg:u.message,status:u.status}}}async function Rr(i){const n=`https://apiv3.shanbay.com/wordscollection/words_check?vocab_ids=${i}`;try{return{data:await te(n,{credentials:"include",mode:"cors",parseResponse:JSON.parse}),msg:"success",status:200}}catch(o){const u=o;return{data:u.data,msg:u.message,status:u.status}}}async function Cr(i){const n="https://apiv3.shanbay.com/news/words";try{return{data:await te(n,{body:JSON.stringify({article_id:"",business_id:2,paragraph_id:"",sentence_id:"",source_content:"",source_name:"",summary:i.word,vocab_id:i.wordId}),credentials:"include",headers:{"Content-Type":"application/json"},method:"POST",mode:"cors",parseResponse:JSON.parse}),msg:"success",status:200}}catch(o){const u=o;return{data:u.data,msg:u.message,status:u.status}}}async function Sr(i){const n=`https://apiv3.shanbay.com/abc/words/vocabularies/${i.id}/examples`;try{return{data:await te(n,{credentials:"include",mode:"cors",parseResponse:JSON.parse}),msg:"success",status:200}}catch(o){const u=o;return{data:u.data,msg:u.message,status:u.status}}}function Ve(){const i="remindAlarm";(Q==null?void 0:Q.alarm)==="true"?(W.alarms.create(i,{delayInMinutes:60,periodInMinutes:180}),W.alarms.onAlarm.addListener(async()=>{if((Q==null?void 0:Q.alarm)==="false")return W.alarms.clear(i);try{const n=await kr();if(n.status===200){const u=JSON.parse(n.data).total;u===0?W.action.setBadgeText({text:""}):(W.action.setBadgeText({text:`${u}`}),W.notifications.create({iconUrl:W.runtime.getURL("/icon/128.png"),message:`今日剩余单词数量为${u}，请及时学习！`,title:"扇贝单词学习提醒",type:"basic"}))}}catch{}})):W.alarms.clear(i)}async function kr(){const i="https://apiv3.shanbay.com/wordscollection/learning/words/today_learning_items?page=1&type_of=REVIEW&ipp=10";try{const n=await te(i,{credentials:"include",mode:"cors",parseResponse:JSON.parse});return{data:Rt(n.data),msg:"success",status:200}}catch(n){const o=n;return{data:o.data,msg:o.message,status:o.status}}}function We(i,n){return new RegExp(`^https?://(www\\.)?${n}`,"i").test(i)}async function Ur(i){const n=i.url;n&&W.runtime.sendMessage({action:Z.PlayAudio,url:n})}function Vr(){}function pe(i,...n){}const Mr={debug:(...i)=>pe(console.debug,...i),log:(...i)=>pe(console.log,...i),warn:(...i)=>pe(console.warn,...i),error:(...i)=>pe(console.error,...i)};let be;try{be=Br.main(),be instanceof Promise&&console.warn("The background's main() function return a promise, but it must be synchronous")}catch(i){throw Mr.error("The background crashed on startup!"),i}return be}();
background;
